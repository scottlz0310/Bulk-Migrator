src/配下のスクリプト群（auth.py, config_manager.py, filelock.py, logger.py, main.py, rebuild_skip_list.py, skiplist.py, transfer.py など）を逆アセンブル的に分析し、AIが同様のスクリプトを再現できるような仕様書（設計書）を作成します。

---

# Bulk-Migrator仕様書（src/配下スクリプト概要）

## 1. プロジェクト概要
Bulk-Migratorは、OneDriveやSharePointなどのクラウドストレージ間で大量のファイルを安全かつ効率的に移行・管理するためのPython製ツール群です。設定管理、認証、ファイル転送、スキップリスト管理、ログ記録など、複数の機能モジュールで構成されています。

---

## 2. モジュール構成と役割

### 2.1 auth.py
- **目的**: クラウドサービス（例: Microsoft Graph API）への認証・トークン管理。
- **主な機能**:
  - OAuth2認証フローの実装
  - アクセストークンの取得・更新
  - 認証情報の安全な保存・読み出し

### 2.2 config_manager.py
- **目的**: 設定ファイル（config/config.json等）の読み込み・検証・管理。
- **主な機能**:
  - JSON形式の設定ファイルのパース
  - 設定値のバリデーション
  - 設定値の取得API

### 2.3 filelock.py
- **目的**: 複数プロセス/スレッドによる同時実行時の排他制御。
- **主な機能**:
  - ファイルロックの取得・解放
  - ロック状態の監視

### 2.4 logger.py
- **目的**: ログ出力の統一管理。
- **主な機能**:
  - 標準出力・ファイルへのログ出力
  - ログレベル（INFO, WARNING, ERROR等）の制御
  - ログフォーマットの統一

### 2.5 main.py
- **目的**: メインエントリーポイント。全体の制御・オーケストレーション。
- **主な機能**:
  - 設定・認証・ロガーの初期化
  - コマンドライン引数のパース
  - ファイル転送処理の起動
  - エラー処理・終了処理

### 2.6 rebuild_skip_list.py
- **目的**: スキップリスト（転送対象外ファイルリスト）の再構築。
- **主な機能**:
  - 既存スキップリストの読み込み
  - 新規スキップリストの生成・保存

### 2.7 skiplist.py
- **目的**: スキップリストの管理・参照。
- **主な機能**:
  - スキップリストの読み込み・書き込み
  - ファイルがスキップ対象かどうかの判定

### 2.8 transfer.py
- **目的**: ファイル転送処理の中核。
- **主な機能**:
  - 転送対象ファイルの列挙
  - 転送処理の実行（アップロード/ダウンロード）
  - 転送結果の記録
  - エラー・リトライ処理

---

## 3. 共通設計方針

- **設定ファイル**: JSON形式で管理。config_manager.pyで一元管理。
- **認証**: OAuth2ベース。トークンの自動更新対応。
- **排他制御**: filelock.pyでファイル単位のロックを実装。
- **ログ**: logger.pyで統一。ログレベル・出力先を柔軟に設定可能。
- **スキップリスト**: JSONまたはテキスト形式。skiplist.pyで管理。
- **エラー処理**: 例外キャッチ、リトライ、ログ記録を徹底。
- **CLI対応**: main.pyでコマンドライン引数を受け付け、柔軟な実行制御。

---

## 4. 典型的な処理フロー

1. main.pyが起動し、設定・認証・ロガーを初期化
2. スキップリスト・転送対象ファイルリストを取得
3. transfer.pyでファイル転送を実行
4. 転送結果・エラーをログに記録
5. 必要に応じてスキップリストをrebuild_skip_list.pyで再生成

---

## 5. AIによる再実装のためのポイント

- 各モジュールは単一責任原則に従い、役割を明確に分離
- 設定・認証・ロギング・排他制御・ファイル転送などは独立したクラス/関数で実装
- 例外処理・リトライ・ログ記録を徹底
- テスト容易性を考慮し、外部依存部分はインターフェース化
- CLI引数や設定ファイルで柔軟に動作を切り替え可能

---
